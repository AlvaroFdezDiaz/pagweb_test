
var level=0;$(document).ready(function(){FiltersInit();FiltersInitCommon();});function FiltersInitCommon(){if($("#Fk_CountryId").val()==null||$("#Fk_CountryId").val()==''){$("#L2d").html($("#lEmtpy").html());$("#L3d").html($("#lEmtpy").html());$("#L5d").html($("#lEmtpy").html());$("#L6d").html($("#lEmtpy").html());$("#L7d").html($("#lEmtpy").html());$("#L8d").html($("#lEmtpy").html());}else if($("#Fk_Level2Id").val()==null||$("#Fk_Level2Id").val()==''){$("#L2d").html($("#lEmtpy").html());$("#L3d").html($("#lEmtpy").html());if($("#Fk_Level5Id").val()==null||$("#Fk_Level5Id").val()==''){$("#L5d").html($("#lEmtpy").html());}
$("#L6d").html($("#lEmtpy").html());$("#L7d").html($("#lEmtpy").html());$("#L8d").html($("#lEmtpy").html());}else if($("#Fk_Level3Id").val()==null||$("#Fk_Level3Id").val()==''){$("#L3d").html($("#lEmtpy").html());if($("#Fk_Level2Id :selected").attr('cl')!='3'||(($("#Fk_Level5Id").val()==null||$("#Fk_Level5Id").val()==''))){$("#L5d").html($("#lEmtpy").html());if($("#Fk_Level5Id").val()=='0'){$("#L7d").html($("#lEmtpy").html());}}}else if($("#Fk_Level5Id").val()==null||$("#Fk_Level5Id").val()==''){$("#L5d").html($("#lEmtpy").html());$("#L6d").html($("#lEmtpy").html());$("#L7d").html($("#lEmtpy").html());$("#L8d").html($("#lEmtpy").html());}else if($("#Fk_Level6Id").val()==null||$("#Fk_Level6Id").val()==''){$("#L6d").html($("#lEmtpy").html());$("#L8d").html($("#lEmtpy").html());}else if(($("#Fk_Level7Id").val()==null||$("#Fk_Level7Id").val()=='')){$("#L7d").html($("#lEmtpy").html());$("#L8d").html($("#lEmtpy").html());};if($("#BuildingSubtype").length>0){$("#Fk_BuildingTypeId").change(function(){ChangeBuilding();return false;});};if($("#TransactionType").length>0){$("#TransactionType").change(function(){FEChangeTransaction();return false;});};FEChangeSurface();TransformSubtypeDropdown();FEChangeTransaction();};function ChangeTransaction(trans){$("#TransactionType option[value="+trans+"]").prop("selected",true);FEChangeTransaction();SearchShow();_GLMainProperty.ResetPage();if($("#mapLoaded").val()=="0"){_GLMainPropertyHead.Load();};_GLMainProperty.Action='CT';_GLMainProperty.Load();};function ChangeBuilding(){FEChangeType();FEChangeSurface();};function FEChangeTransaction(){var transactionTypeId=$("#TransactionType").val();GetOptionToDdlPrice(transactionTypeId);switch(transactionTypeId){case'1':$("#OfferPriceToContainer").show();$("#RentPriceToContainer").hide();$("#SharePriceToContainer").hide();$("#TransferPriceToContainer").hide();$("#EmptyPrice").hide();break;case'3':case"8":$("#OfferPriceToContainer").hide();$("#RentPriceToContainer").show();$("#SharePriceToContainer").hide();$("#TransferPriceToContainer").hide();$("#EmptyPrice").hide();break;case'4':$("#OfferPriceToContainer").hide();$("#RentPriceToContainer").hide();$("#SharePriceToContainer").hide();$("#TransferPriceToContainer").show();$("#EmptyPrice").hide();break;case'7':$("#OfferPriceToContainer").hide();$("#RentPriceToContainer").hide();$("#SharePriceToContainer").show();$("#TransferPriceToContainer").hide();$("#EmptyPrice").hide();break;default:break;};if(transactionTypeId=="3"){$("#IsOptionShell_Div").show();}else{$("#IsOptionShell_Div").hide();}
$("#TransactionType9").attr('checked',false);$("#IsOptionSell").val('');};function FEChangeSurface(){if($("#SurfaceFrom")==null||$("#SurfaceFrom").length==0)return;var typeId=$("#Fk_BuildingTypeId").val();var minSurface=30;var maxSurface=300;var firstInterval=30;var secondInterval=20;switch(typeId){case'3':case'4':minSurface=25;maxSurface=800;firstInterval=25;secondInterval=50;break;case'8':minSurface=4;maxSurface=40;firstInterval=4;secondInterval=8;break;case'6':case'7':minSurface=100;maxSurface=3000;firstInterval=100;secondInterval=200;break;case'12':minSurface=2;maxSurface=25;firstInterval=3;secondInterval=5;break;default:break;}
var filterFrom=$("#filterFrom").val();$("#SurfaceFrom")[0].options.length=1;$("#SurfaceFrom").append($("<option></option>").attr("value",minSurface).text(filterFrom+minSurface+' m2'));minSurface=minSurface+firstInterval;for(minSurface;minSurface<=maxSurface;minSurface=minSurface+secondInterval){$("#SurfaceFrom").append($("<option></option>").attr("value",minSurface).text(filterFrom+minSurface+' m2'));}};function TransformSubtypeDropdown(){$("#Fk_BuildingSubtypeId").dropdownchecklist("destroy");$("#Fk_BuildingSubtypeId").dropdownchecklist({width:144,firstItemChecksAll:true});};function CheckNumberOptions(data){var number;if(data.lastIndexOf("latitude")!=data.indexOf("latitude")){number=2;}
else if(data.indexOf("latitude")>0){number=1;}else{number=0;}
return number;};function GetOptionToDdlSurface(buildingTypeId){var prts=new Object();prts.fkBuildingTypeId=buildingTypeId;$.ajax({type:"Get",url:'/Dictionary/ListSurface/',data:prts,async:false,success:function(data){$("#SurfaceFrom").find("option").remove();$(data).each(function(){$("#SurfaceFrom").append(this.toString());});}});}
function GetOptionToDdlPrice(transactionTypeId){var prts=new Object();prts.fkBuildingTypeId=$("#Fk_BuildingTypeId").val();prts.fkTransactionTypeId=transactionTypeId;$.ajax({type:"Get",url:'/Dictionary/ListPrice/',data:prts,async:false,success:function(data){switch(transactionTypeId){case"1":$("#OfferPriceTo").find("option").remove();$(data).each(function(){$("#OfferPriceTo").append(this.toString());});break;case"3":case"8":$("#RentPriceTo").find("option").remove();$(data).each(function(){$("#RentPriceTo").append(this.toString());});break;case"4":$("#TransferPriceTo").find("option").remove();$(data).each(function(){$("#TransferPriceTo").append(this.toString());});break;case"7":$("#SharePriceTo").find("option").remove();$(data).each(function(){$("#SharePriceTo").append(this.toString());});break;}}});}
function FEChangeLocation(ddlName,parentId,chLevel,includeAll){var level;switch(ddlName){case'Fk_CountryId':level='0';break;case'Fk_Level2Id':level='2';break;case'Fk_Level3Id':level='3';break;case'Fk_Level5Id':level='5';break;case'Fk_Level6Id':level='6';break;case'Fk_Level7Id':level='7';break;case'Fk_Level8Id':level='8';break;}
var countryId=$("#Fk_CountryId").val();var _prts=new Object();_prts.Fk_CountryId=countryId;_prts.Prefix="";switch(level){case'0':if(countryId===portugalCountryId){_prts.Level=5;_prts.ParentId=0;_prts.Name="Fk_Level5Id";$("#L5d").html($("#lLoading").html());$("#L2d").html($("#lEmtpy").html());}else{_prts.Level=2;_prts.ParentId=$("#Fk_CountryId").val();_prts.Name="Fk_Level2Id";$("#L2d").html($("#lLoading").html());$("#L5d").html($("#lEmtpy").html());}
$("#L3d").html($("#lEmtpy").html());$("#L6d").html($("#lEmtpy").html());$("#L7d").html($("#lEmtpy").html());$("#L8d").html($("#lEmtpy").html());break;case'2':_prts.ParentId=$("#Fk_Level2Id").val();if($("#Fk_Level2Id :selected").attr('cl')=="3"){_prts.Level=5;_prts.Name="Fk_Level5Id";}
else{_prts.Level=3;_prts.Name="Fk_Level3Id";}
$("#L5d").html($("#lEmtpy").html());$("#L6d").html($("#lEmtpy").html());$("#L7d").html($("#lEmtpy").html());$("#L8d").html($("#lEmtpy").html());$("#L3d").html($("#lLoading").html());break;case'3':_prts.Level=5;_prts.Name="Fk_Level5Id";_prts.ParentId=parentId!=null?parentId:$("#Fk_Level3Id").val()!='0'?$("#Fk_Level3Id").val():$("#Fk_Level2Id").val();_prts.ChildrenLevel=chLevel!=null?chLevel:$("#Fk_Level3Id").val()!='0'?2:1;$("#L6d").html($("#lEmtpy").html());$("#L7d").html($("#lEmtpy").html());$("#L8d").html($("#lEmtpy").html());$("#L5d").html($("#lLoading").html());break;case'5':_prts.ParentId=$("#Fk_Level5Id").val();if($("#Fk_Level5Id :selected").attr('cl')=="1"){_prts.Level=6;_prts.Name="Fk_Level6Id";_prts.ChildrenLevel=1;$("#L6d").html($("#lLoading").html());$("#L7d").html($("#lEmtpy").html());}
else if($("#Fk_Level5Id :selected").attr('cl')=="2"){_prts.Level=7;_prts.Name="Fk_Level7Id";_prts.ChildrenLevel=2;$("#L6d").html($("#lEmtpy").html());$("#L7d").html($("#lLoading").html());}
else{$("#L6d").html($("#lEmtpy").html());$("#L7d").html($("#lEmtpy").html());}
$("#L8d").html($("#lEmtpy").html());break;case'6':_prts.ParentId=$("#Fk_Level6Id").val();if($("#Fk_Level6Id :selected").attr('cl')=="1"){_prts.Level=7;_prts.Name="Fk_Level7Id";_prts.ChildrenLevel=1;$("#L7d").html($("#lLoading").html());}
else{$("#L7d").html($("#lEmtpy").html());}
$("#L8d").html($("#lEmtpy").html());break;case'7':_prts.ParentId=$("#Fk_Level7Id").val();if($("#Fk_Level7Id :selected").attr('cl')=="1"){_prts.Level=8;_prts.Name="Fk_Level8Id";_prts.ChildrenLevel=1;$("#L8d").html($("#lLoading").html());}
else{$("#L8d").html($("#lEmtpy").html());}
break;};var url='/Common/LocationDDL?PromotionList=';var urlIncludeAll='/Common/LocationAllDDL?PromotionList=';if(includeAll){url=urlIncludeAll;}
$.get(url+window._promotionList,_prts,function(data){switch(level){case'0':if(countryId===portugalCountryId){$("#L5d").html(data);$("#Fk_Level5Id").change(function(){FEChangeLocation("Fk_Level5Id");return false;});}else{$("#L2d").html(data);$("#Fk_Level2Id").change(function(){FEChangeLocation("Fk_Level2Id");return false;});if(CheckNumberOptions(data)==1){FEChangeLocation("Fk_Level2Id");}}
break;case'2':if($("#Fk_Level2Id :selected").attr('cl')=="3"){$("#L3d").html($("#lEmtpy").html());if(CheckNumberOptions(data)==0)
$("#L5d").html($("#lEmtpy").html());else
$("#L5d").html(data);$("#Fk_Level5Id").change(function(){FEChangeLocation("Fk_Level5Id");return false;});if($("#Fk_Level5Id").find("option").length==1){$("#Fk_Level5Id").trigger("change");}
if($("#Fk_Level5Id").find("option").length==0){$("#Fk_Level5Id").trigger("change");}}
else{if(CheckNumberOptions(data)==0)
$("#L3d").html($("#lEmtpy").html());else
$("#L3d").html(data);$("#Fk_Level3Id").change(function(){FEChangeLocation("Fk_Level3Id");return false;});if($("#Fk_Level3Id").find("option").length==1){$("#Fk_Level3Id").trigger("change");}
if($("#Fk_Level3Id").find("option").length==0){FEChangeLocation("Fk_Level5Id");}else{FEChangeLocation("Fk_Level3Id",$("#Fk_Level2Id").val(),1);}}
break;case'3':if(CheckNumberOptions(data)==0)
$("#L5d").html($("#lEmtpy").html());else
$("#L5d").html(data);$("#Fk_Level5Id").change(function(){FEChangeLocation("Fk_Level5Id");return false;});if($("#Fk_Level5Id").find("option").length==1){$("#Fk_Level5Id").trigger("change");}
if($("#Fk_Level5Id").find("option").length==0){FEChangeLocation("Fk_Level5Id");}
break;case'5':if($("#Fk_Level5Id :selected").attr('cl')=="2"){$("#L6d").html($("#lEmtpy").html());if(CheckNumberOptions(data)==0)
$("#L7d").html($("#lEmtpy").html());else
$("#L7d").html(data);$("#Fk_Level7Id").change(function(){FEChangeLocation("Fk_Level7Id");return false;});if($("#Fk_Level7Id").find("option").length==1){$("#Fk_Level7Id").trigger("change");}
if($("#Fk_Level7Id").find("option").length==0){FEChangeLocation("Fk_Level8Id");}}
else
if($("#Fk_Level5Id :selected").attr('cl')=="1"){if(CheckNumberOptions(data)==0)
$("#L6d").html($("#lEmtpy").html());else
$("#L6d").html(data);$("#Fk_Level6Id").change(function(){FEChangeLocation("Fk_Level6Id");return false;});if($("#Fk_Level6Id").find("option").length==1){FEChangeLocation("Fk_Level6Id");}
if($("#Fk_Level6Id").find("option").length==0){FEChangeLocation("Fk_Level7Id");}}
else{$("#L6d").html($("#lEmtpy").html());$("#L7d").html($("#lEmtpy").html());$("#L8d").html($("#lEmtpy").html());}
break;case'6':if(CheckNumberOptions(data)==0)
$("#L7d").html($("#lEmtpy").html());else
$("#L7d").html(data);$("#Fk_Level7Id").change(function(){FEChangeLocation("Fk_Level7Id");return false;});if($("#Fk_Level7Id").find("option").length==1){$("#Fk_Level7Id").trigger("change");}
break;case'7':if(CheckNumberOptions(data)==0)
$("#L8d").html($("#lEmtpy").html());else
$("#L8d").html(data);if($("#Fk_Level8Id").find("option").length==1){$("#Fk_Level8Id").trigger("change");}
break;default:break;}});};

var portugalCountryId="620";function FiltersInit(){$("#Fk_CountryId,#Fk_Level3Id,#Fk_Level5Id,#Fk_Level6Id,#Fk_Level7Id,#Fk_Level8Id").change(function(){FEChangeLocation(this.name,null,null,false);});$("#Fk_Level2Id").change(function(){FEChangeLocation(this.name,null,null,false);});};function FEChangeType(){var buildinTypeId=$("#Fk_BuildingTypeId").val();switch(buildinTypeId){case'1':$("#RoomsFrom").attr('disabled',false);break;case'2':$("#RoomsFrom").attr('disabled',false);break;default:$("#RoomsFrom option[value='']").prop("selected",true);$("#RoomsFrom").attr('disabled',true);break;}
GetOptionToDdlPrice($("#TransactionType").val());GetOptionToDdlSurface(buildinTypeId);$.get('/Dictionary/ListBuildingSubType/'+buildinTypeId+'?rnd='+Math.random(),function(data){$("#Fk_BuildingSubtypeId")[0].options.length=1;$(data).each(function(){if(this.Pk_Id!=null&&this.Value!=null){$("#Fk_BuildingSubtypeId").append($("<option></option>").attr("value",this.Pk_Id).text(this.Value));};});TransformSubtypeDropdown();});};function FEChangeLocationCompactSearch(ddlName,parentId,chLevel){var level;switch(ddlName){case'Fk_CountryId':level='0';break;case'Fk_Level2Id':level='2';break;case'Fk_Level3Id':level='3';break;case'Fk_Level5Id':level='5';break;}
var countryId=$("#Fk_CountryId").val();var _prts=new Object();_prts.Fk_CountryId=countryId;_prts.Prefix="";switch(level){case'0':if(countryId===portugalCountryId){_prts.Level=5;_prts.ParentId=0;_prts.Name="Fk_Level5Id";$("#L5d").html($("#lLoading").html());}else{_prts.Level=2;_prts.ParentId=$("#Fk_CountryId").val();_prts.Name="Fk_Level2Id";$("#L2d").html($("#lLoading").html());}
$("#L2d").html($("#lEmtpy").html());$("#L3d").html($("#lEmtpy").html());$("#L5d").html($("#lEmtpy").html());break;case'2':_prts.ParentId=$("#Fk_Level2Id").val();if($("#Fk_Level2Id :selected").attr('cl')=="3"){_prts.Level=5;_prts.Name="Fk_Level5Id";}
else{_prts.Level=3;_prts.Name="Fk_Level3Id";}
$("#L3d").html($("#lLoading").html());$("#L5d").html($("#lEmtpy").html());break;case'3':_prts.Level=5;_prts.Name="Fk_Level5Id";_prts.ParentId=parentId!=null?parentId:$("#Fk_Level3Id").val()!='0'?$("#Fk_Level3Id").val():$("#Fk_Level2Id").val();_prts.ChildrenLevel=chLevel!=null?chLevel:$("#Fk_Level3Id").val()!='0'?2:1;$("#L5d").html($("#lLoading").html());break;};if($("#"+ddlName).val()==0&&level==2){$("#L3d").html($("#lEmtpy").html());return;}
$.ajax({url:'/Common/CompacSearchLocationDDL?publicationId='+$("#PublicationId").val(),data:_prts,type:"GET",cache:false,success:function(data){switch(level){case'0':if(countryId===portugalCountryId){$("#L5d").html(data);$("#Fk_Level5Id").change(function(){FEChangeLocationCompactSearch("Fk_Level5Id",5);return false;});}else{$("#L2d").html(data);$("#Fk_Level2Id").change(function(){FEChangeLocationCompactSearch("Fk_Level2Id");return false;});if(CheckNumberOptions(data)==1){FEChangeLocationCompactSearch("Fk_Level2Id");}}
break;case'2':if($("#Fk_Level2Id :selected").attr('cl')=="3"){$("#L3d").html($("#lEmtpy").html());if(CheckNumberOptions(data)==0)
$("#L5d").html($("#lEmtpy").html());else
$("#L5d").html(data);$("#Fk_Level5Id").change(function(){FEChangeLocationCompactSearch("Fk_Level5Id");return false;});if($("#Fk_Level5Id").find("option").length==1){$("#Fk_Level5Id").trigger("change");}
if($("#Fk_Level5Id").find("option").length==0){$("#Fk_Level5Id").trigger("change");}}
else{if(CheckNumberOptions(data)==0)
$("#L3d").html($("#lEmtpy").html());else
$("#L3d").html(data);$("#Fk_Level3Id").change(function(){FEChangeLocationCompactSearch("Fk_Level3Id");return false;});if($("#Fk_Level3Id").find("option").length==1){$("#Fk_Level3Id").trigger("change");}
if($("#Fk_Level3Id").find("option").length==0){FEChangeLocationCompactSearch("Fk_Level5Id");}else{FEChangeLocationCompactSearch("Fk_Level3Id",$("#Fk_Level2Id").val(),1);}}
break;case'3':if(CheckNumberOptions(data)==0)
$("#L5d").html($("#lEmtpy").html());else
$("#L5d").html(data);$("#Fk_Level5Id").change(function(){FEChangeLocationCompactSearch("Fk_Level5Id");return false;});if($("#Fk_Level5Id").find("option").length==1){$("#Fk_Level5Id").trigger("change");}
if($("#Fk_Level5Id").find("option").length==0){FEChangeLocationCompactSearch("Fk_Level5Id");}
break;default:break;}}});};

function resizeSearcherCompactSearcher(newBreakpoint){document.body.setAttribute("data-media",newBreakpoint);};function loadMessageCompactSearcher(){parent.postMessage({'idIb2c':"inmofactory_Ib2c_BuscadorCompacto",'heightFrame':getDocHeight(),'sendPostMessageHeighIframe':false},'*');};function receiveMessageCompactSearcher(event){if(event.data.sendPostMessageHeighIframe){parent.postMessage({'idIb2c':"inmofactory_Ib2c_BuscadorCompacto",'heightFrame':getDocHeight(),'sendPostMessageHeighIframe':false},'*');}
resizeSearcherCompactSearcher(event.data.dataMedia);0}
$(document).ready(function(){window.addEventListener("message",receiveMessageCompactSearcher,false);window.addEventListener("load",loadMessageCompactSearcher,false);});
